<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<style type="text/css">
	table{
		border :1px solid black;
		margin: 2px auto;
	}
	input[type="button"], input[type="reset"]{
		display:inline;
		margin: 2px auto;
	}
	#reg{
		text-align: center;	
	}
	.result{
		font-size: 2px;
	}
</style>
<script type="text/javascript">
	function idCheck(f) {
		var id = f.id.value;
		var result = document.getElementById('result1');
		var regExpID = /^[a-z][a-z0-9_-]{4,15}$/;
		
		if(id == ''){
			result.style.color = "red";			
			result.textContent = '필수 정보입니다.';
		}else{
			if(regExpID.test(id)){
				result.textContent = '멋진 아이디군요!';
				result.style.color = "green";
				return true;
			}else{
				result.textContent = '5~16자 사이의 영문 소문자, 숫자와 특수기호(-,_)만 사용 가능합니다.';
				result.style.color = "red";
				return false;
			}
		}
	}
	function pwCheck(f) {
		var pw = f.pw.value;
		var regExpPw = /^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])[A-Za-z0-9!@#%&*-_?]{8,16}$/;
		var result = document.getElementById('result2');
		
		if(pw == ''){
			result.style.color = "red";			
			result.textContent = '필수 정보입니다.';
		}else{
			
			if(regExpPw.test(pw)){
				result.textContent = '사용 가능한 비밀번호 입니다.';
				result.style.color = "green";
				return true;
			}else{
				result.textContent = '8~16자 영문 대 소문자, 숫자, 특수문자를 사용하세요.';
				result.style.color = "red";
				return false;
			}
		}
		
	}function pwCheck2(f) {
		var pw = f.pw.value;
		var pw2 = f.pw2.value;
		var result2 = document.getElementById('result3');
		
			if(!pwCheck(f)){
				alert('비밀번호를 확인하세요.');
				f.pw.focus();
				return false;
			}
			if(pw == pw2){
				result2.style.color = "green";	
				result2.textContent = '비밀번호가 확인되었습니다.';
				return true;
			}else{
				result2.style.color = "red";	
				result2.textContent = '비밀번호가 일치하지 않습니다.';
				return false;
			}
		
	}
	function emailCheck(f) {
		var email = f.email.value;
		var result = document.getElementById('result4');
		var regExpEmail = /^[a-z][a-z0-9\-_]+@[a-zA-Z0-9]{3,}(\.[a-zA-Z]{2,6}){1,2}/;
		
		if(email == ''){
			result.style.color = "red";			
			result.textContent = '필수 정보입니다.';
		}else{
			if(regExpEmail.test(email)){
				result.textContent = '이메일이 확인되었습니다.';
				result.style.color = "green";
				return true;
			}else{
				result.textContent = '이메일 주소를 다시 확인해주세요.';
				result.style.color = "red";
				return false;
			}
		}
	}
	function phoneCheck(f) {
		var phone1 = f.phone1.value;
		var phone2 = f.phone2.value;
		var result = document.getElementById('result5');
		var regExpPhone1 = /^[0-9]{3,4}$/;;
		var regExpPhone2 = /^[0-9]{4}$/;;
		
		if(phone1 == '' && phone2 == ''){
			result.style.color = "red";			
			result.textContent = '필수 정보입니다.';
		}else{
			if(regExpPhone1.test(phone1) && regExpPhone2.test(phone2) ){
				result.textContent = '휴대폰 번호가 확인되었습니다.';
				result.style.color = "green";
				return true;
			}else{
				result.textContent = '휴대폰 번호를 다시 확인해주세요.';
				result.style.color = "red";
				return false;
			}
		}
	}
	
	function fn_personalIfCheck(f) {
		
		// 주민등록 번호 검증 방법
		
		// 주민등록번호: 801212-123456 7
		//    검증번호: 234567 892345
		
		// 1. 주민등록번호와 검증번호를 1:1로 매칭해서 곱한다. 그 결과를 모두 더한다. (total)
		//    total = 8*2 + 0*3 + 1*4 + ... + 6*5
		// 2. 주민등록번호 마지막 숫자 = (11 - total % 11)%10 이면 정상 주민등록번호이다.
		
		var p1 = f['personal-id1'].value;
		var p2 = f['personal-id2'].value;
		var total = 0;
	
		for(let i = 0; i< p1.length; i++){
			total += (p1.charAt(i) + (i+2));
		}
		for(let i = 0; i<p2.length-1; i++){
			if(i<2){
				total += (p2.charAt(i) * (i+8));
			}else{
				total += (p2.charAt(i) * i);
			}
		}
		var result = document.getElementById('personal-id-result');
		if((11 - (total % 11)) % 10 == p2.charAt(6)){
			result.textContent = '올바른  주민등록번호입니다.'
			
			// 생일 채우기
			switch(p2.charAt(0)){
			case '1' :
			case '2' :
					f.year.value = '19' + p1.subString(0,2);
					break;
			case '3' :
			case '4' :
					f.year.value = '20' + p1.subString(0,2);
					break;
			}
			
			// 성별 채우기
			switch(p2.charAt(10)){
				case '1':
				case '3': f.gender.value = 'm';
						break;
				case '2': 
				case '3': f.gender.value = 'm';
						break;
			}
		
		
		}else{
			result.textContent = '잘못된  주민등록번호입니다.'
			return false;
		}
	}
	
	function send(f) {
		if ( !idCheck(f) ) {
			alert('아이디를 확인하세요.');
			f.id.focus();
			return;
		}
		if ( !pwCheck(f) || !pwCheck2(f)) {
			alert('비밀번호를 확인하세요.');
			f.pw.focus();
			return;
		}
		if ( !emailCheck(f) ) {
			alert('이메일을 확인하세요.');
			f.email.focus();
			return;
		}
		if ( !phoneCheck(f) ) {
			alert('핸드폰 번호를 확인하세요.');
			f.phone.focus();
			return;
		}	
		if (!fn_personalIdCheck(f)){
			alert('주민 등록 번호를 확인하세요.');
			f.personal-id1.focus();
			return;
		}
		f.action = '#';
		f.submit();
	}
</script>
</head>
<body>
	<h3 id="reg">회원가입</h3>
	<form method="post">
		<table>
			<tr>
				<td>아이디</td>
				<td><input type = "text" name = "id" onkeyup="idCheck(this.form)"></td>
			</tr>
			<tr>
				<td colspan="2" id="result1" class="result"></td>
			</tr>
			<tr>
				<td>비밀번호</td>
				<td><input type = "password" name = "pw" onkeyup="pwCheck(this.form)"></td>
			</tr>
			<tr>
				<td colspan="2" id="result2" class="result"></td>
			</tr>
			<tr>
				<td>비밀번호 확인</td>
				<td><input type= "password" name = "pw2" onkeyup="pwCheck2(this.form)"></td>
			</tr>
			<tr>
				<td colspan="2" id="result3" class="result"></td>
			</tr>
			<tr>
				<td>이메일</td>
				<td><input type="text" name = "email" onkeyup="emailCheck(this.form)"></td>
			</tr>
			<tr>
				<td colspan="2" id="result4" class="result"></td>
			</tr>
			<tr>
				<td>핸드폰번호</td>
				<td>
					<select name = "mobile1" id = "mobile1">
						<option value="010">010</option>
						<option value="011">011</option>
						<option value="016">016</option>
						<option value="019">019</option>
					</select>
				 - <input type = "text" name="phone1" onkeyup="phoneCheck(this.form)" maxlength="4" style="width:33px;"> - 
					<input type = "text" name="phone2" onkeyup="phoneCheck(this.form)" maxlength="4" style="width:33px;">
					<input type="hidden" name = "mobile"/>
				</td>
			</tr>
			<tr>
				<td colspan="2" id="result5" class="result"></td>
			</tr>
			<tr>
				<td>성별</td>
				<td><!-- <select id = "gender">
						<option value="">성별</option>
						<option value="M">남자</option>
						<option value="W">여자</option>
					</select> -->
					<input type="radio" name = "gender" value = "m" id="male"/>
					<label for = "male">남자</label>	
					<input type="radio" name = "gender" value = "f" id="female"/>
					<label for = "female">여자</label>	
				</td>
			</tr>
			<tr>
				<td colspan="2" id="result6" class="result"></td>
			</tr>
			<tr>
				<td><label for="personal-id1">주민등록번호</label></td>
				<td>
				<input type="text" name = "personal-id1" size="5" id = "personal-id1">
				 - <input type="password" size="6" name = "personal-id2"/>
				 <input type ="button" value="검증" onclick = "fn_personalIfCheck(this.form)"/>
				 <div id="personal-id-result"></div>
				 	<input type="text" name="year" size="1" readonly/>년
				 	<input type="text" name="month" size="1" readonly/>월
				 	<input type="text" name="day" size="1" readonly/>일
				 </td>
			</tr>
			<tr>
				<td colspan="2" id="result7" class="result"></td>
			</tr>
			<tr>
				<td>생일</td>
				<td><input type = "text" name="birth" onkeyup=""></td>
			</tr>
			<tr>
				<td colspan="2" id="result8" class="result"></td>
			</tr>
			<tr>
				<td colspan="2">
					<input type = "button" value = "전송" onclick="send(this.form)">
					<input type = "reset" value = "다시작성">
				</td>
				
			</tr>
		</table>

	</form>

</body>
</html>