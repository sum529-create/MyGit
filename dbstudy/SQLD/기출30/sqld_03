drop table SQLD_D3;

create table SQLD_D3(
    계층번호 number,
    상위계층번호 number
);
INSERT INTO SQLD_D3(계층번호, 상위계층번호) VALUES(1,NULL);
INSERT INTO SQLD_D3(계층번호, 상위계층번호) VALUES(2,NULL);
INSERT INTO SQLD_D3(계층번호, 상위계층번호) VALUES(4,1);
INSERT INTO SQLD_D3(계층번호, 상위계층번호) VALUES(5,1);
INSERT INTO SQLD_D3(계층번호, 상위계층번호) VALUES(6,2);
INSERT INTO SQLD_D3(계층번호, 상위계층번호) VALUES(7,2);
INSERT INTO SQLD_D3(계층번호, 상위계층번호) VALUES(8,4);
INSERT INTO SQLD_D3(계층번호, 상위계층번호) VALUES(9,5);
INSERT INTO SQLD_D3(계층번호, 상위계층번호) VALUES(10,6);
INSERT INTO SQLD_D3(계층번호, 상위계층번호) VALUES(11,7);

SELECT LEVEL,
LPAD('** ', (LEVEL-1)*2,' ') || 계층번호 AS 계층트리,
계층번호,
상위계층번호
FROM SQLD_D3
START WITH 상위계층번호 IS NULL
CONNECT BY 계층번호 = PRIOR 상위계층번호;



/*
level 계층트리 계층번호 상위계층번호
  1	      1	      1	      null
  1	      2     	2	      null
*/
